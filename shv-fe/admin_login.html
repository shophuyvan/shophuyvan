<!doctype html><html lang="vi"><head><meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Đăng nhập Admin</title>
<style>body{margin:0;background:#0f172a;color:#e2e8f0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
main{max-width:420px;margin:60px auto;padding:0 16px}.card{background:#0b1222;border:1px solid #1f2a44;border-radius:12px;padding:18px}
input,button{width:100%;padding:10px;border-radius:8px;border:1px solid #334155;background:#111827;color:#e2e8f0;margin-top:10px}
button{background:#2563eb;border-color:#2563eb}</style></head><body><main>
<div class="card"><h2>Đăng nhập quản trị</h2>
<input id="u" placeholder="Tài khoản" value="admin" autocomplete="username"/><input id="p" placeholder="Mật khẩu" type="password" autocomplete="current-password"/>
<button id="btn">Đăng nhập</button><p id="msg"></p>
<p style="font-size:12px;color:#94a3b8">API: <code>https://shv-api.shophuyvan.workers.dev</code></p>
</div>
<script type="module">
const API='https://shv-api.shophuyvan.workers.dev';
async function doLogin(u,p){
  const r=await fetch(API+'/admin/login',{method:'POST',mode:'cors',cache:'no-store',headers:{'content-type':'application/json'},body:JSON.stringify({u,p})});
  if(!r.ok) throw new Error(String(r.status)); const ct=r.headers.get('content-type')||''; let t=''; if(ct.includes('application/json')){const j=await r.json().catch(()=>null); t=(j&&(j.token||j.t||j.id))||'';} else { t=(await r.text()).trim(); } if(!t||t.length<8) throw new Error('bad'); return t;}
btn.onclick=async()=>{msg.textContent='Đang đăng nhập...'; try{const tk=await doLogin(u.value.trim(),p.value); location.href='/admin/?token='+encodeURIComponent(tk);}catch(e){msg.textContent='Đăng nhập thất bại ('+e.message+').';}};
</script></main></body></html>