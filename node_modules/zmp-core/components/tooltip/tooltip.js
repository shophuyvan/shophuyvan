(function zmpComponentLoader(t,e){void 0===e&&(e=!0);var o=t.$,r=t.utils,n=(t.getDevice,t.getSupport),a=t.Class,i=(t.Modal,t.ConstructorMethods);t.ModalMethods;function l(t){this.wrapped=t}function s(t){var e,o;function r(e,o){try{var a=t[e](o),i=a.value,s=i instanceof l;Promise.resolve(s?i.wrapped:i).then((function(t){s?r("return"===e?"return":"next",t):n(a.done?"return":"normal",t)}),(function(t){r("throw",t)}))}catch(t){n("throw",t)}}function n(t,n){switch(t){case"return":e.resolve({value:n,done:!0});break;case"throw":e.reject(n);break;default:e.resolve({value:n,done:!1})}(e=e.next)?r(e.key,e.arg):o=null}this._invoke=function(t,n){return new Promise((function(a,i){var l={key:t,arg:n,resolve:a,reject:i,next:null};o?o=o.next=l:(e=o=l,r(t,n))}))},"function"!=typeof t.return&&(this.return=void 0)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}s.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},s.prototype.next=function(t){return this._invoke("next",t)},s.prototype.throw=function(t){return this._invoke("throw",t)},s.prototype.return=function(t){return this._invoke("return",t)};var u=r.extend,d=r.deleteProps,h=function(t){var e,r;function a(e,r){var a;void 0===r&&(r={});var i=c(a=t.call(this,r,[e])||this),l=n(),s=u({},e.params.tooltip);i.useModulesParams(s),i.params=u(s,r),void 0===r.offset&&l.touch&&"hover"===i.params.trigger&&(i.params.offset=10);var p=i.params,d=p.targetEl,h=p.containerEl;if(!d&&!i.params.delegated)return i||c(a);var v=o(d);if(0===v.length&&!i.params.delegated)return i||c(a);if(v[0]&&v[0].zmpTooltip&&!i.params.delegated)return v[0].zmpTooltip||c(a);var f=o(h||e.$el).eq(0);0===f.length&&(f=e.$el);var m=o(i.render()).eq(0);u(i,{app:e,$targetEl:v,targetEl:v&&v[0],$containerEl:f,containerEl:f&&f[0],$el:m,el:m&&m[0],text:i.params.text||"",visible:!1,opened:!1}),v[0]&&(v[0].zmpTooltip=i);var g,E={};function y(){i.opened?i.hide():i.show(this)}function $(t){i.opened&&(o(t.target).closest(v).length||o(t.target).closest(i.$el).length)||i.hide()}function w(t){g||(g=!0,E.x="touchstart"===t.type?t.targetTouches[0].pageX:t.pageX,E.y="touchstart"===t.type?t.targetTouches[0].pageY:t.pageY,i.show(this))}function T(t){if(g){var e="touchmove"===t.type?t.targetTouches[0].pageX:t.pageX,o="touchmove"===t.type?t.targetTouches[0].pageY:t.pageY;Math.pow(Math.pow(e-E.x,2)+Math.pow(o-E.y,2),.5)>50&&(g=!1,i.hide())}}function b(){g&&(g=!1,i.hide())}function x(){i.show(this)}function z(){i.hide()}function k(){m.hasClass("tooltip-in")||m.removeClass("tooltip-out").remove()}return i.attachEvents=function(){if(m.on("transitionend",k),"click"===i.params.trigger)return i.params.delegated?o(document).on("click",i.params.targetEl,y):i.$targetEl.on("click",y),void o("html").on("click",$);if("manual"!==i.params.trigger)if(l.touch){var t=!!l.passiveListener&&{passive:!0};i.params.delegated?o(document).on(e.touchEvents.start,i.params.targetEl,w,t):i.$targetEl.on(e.touchEvents.start,w,t),e.on("touchmove",T),e.on("touchend:passive",b)}else i.params.delegated?(o(document).on(l.pointerEvents?"pointerenter":"mouseenter",i.params.targetEl,x,!0),o(document).on(l.pointerEvents?"pointerleave":"mouseleave",i.params.targetEl,z,!0)):(i.$targetEl.on(l.pointerEvents?"pointerenter":"mouseenter",x),i.$targetEl.on(l.pointerEvents?"pointerleave":"mouseleave",z))},i.detachEvents=function(){if(m.off("transitionend",k),"click"===i.params.trigger)return i.params.delegated?o(document).on("click",i.params.targetEl,y):i.$targetEl.off("click",y),void o("html").off("click",$);if("manual"!==i.params.trigger)if(l.touch){var t=!!l.passiveListener&&{passive:!0};i.params.delegated?o(document).off(e.touchEvents.start,i.params.targetEl,w,t):i.$targetEl.off(e.touchEvents.start,w,t),e.off("touchmove",T),e.off("touchend:passive",b)}else i.params.delegated?(o(document).off(l.pointerEvents?"pointerenter":"mouseenter",i.params.targetEl,x,!0),o(document).off(l.pointerEvents?"pointerleave":"mouseleave",i.params.targetEl,z,!0)):(i.$targetEl.off(l.pointerEvents?"pointerenter":"mouseenter",x),i.$targetEl.off(l.pointerEvents?"pointerleave":"mouseleave",z))},i.useModules(),i.init(),i||c(a)}r=t,(e=a).prototype=Object.create(r.prototype),e.prototype.constructor=e,p(e,r);var i=a.prototype;return i.setTargetEl=function(t){var e=this;return e.detachEvents(),e.$targetEl=o(t),e.targetEl=e.$targetEl[0],e.attachEvents(),e},i.position=function(t){var e=this,r=e.$el,n=e.app,a=e.$containerEl,i=!!e.params.containerEl,l=e.params.offset||0;r.css({left:"",top:""});var s,p,c,u,d=o(t||e.targetEl),h=[r.width(),r.height()],v=h[0],f=h[1];r.css({left:"",top:""});var m=i&&a.length?a[0].getBoundingClientRect():n;if(d&&d.length>0){if(s=d.outerWidth(),p=d.outerHeight(),void 0===s&&void 0===p){var g=d[0].getBoundingClientRect();s=g.width,p=g.height}var E=d.offset();c=E.left-m.left,u=E.top-m.top;var y=d.parents(".page");y.length>0&&(u-=y[0].scrollTop)}var $=[0,0,0],w=$[0],T=$[1],b="top";f+l<u?T=u-f-l:f<m.height-u-p?(b="bottom",T=u+p+l):(b="middle",(T=p/2+u-f/2)<=0?T=8:T+f>=m.height&&(T=m.height-f-8)),"top"===b||"bottom"===b?((w=s/2+c-v/2)<8&&(w=8),w+v>m.width&&(w=m.width-v-8),w<0&&(w=0)):"middle"===b&&((w=c-v)<8||w+v>m.width)&&(w<8&&(w=c+s),w+v>m.width&&(w=m.width-v-8)),r.css({top:T+"px",left:w+"px"})},i.show=function(t){var e=this,r=e.$el,n=e.$targetEl,a=e.$containerEl;a[0]&&r[0]&&!a[0].contains(r[0])&&a.append(r),e.position(t);var i=o(t);return e.visible=!0,e.opened=!0,n.trigger("tooltip:show"),r.trigger("tooltip:show"),i.length&&i[0]!==n[0]&&i.trigger("tooltip:show"),e.emit("local::show tooltipShow",e),r.removeClass("tooltip-out").addClass("tooltip-in"),e},i.hide=function(){var t=this,e=t.$el,o=t.$targetEl;return t.visible=!1,t.opened=!1,o.trigger("tooltip:hide"),e.trigger("tooltip:hide"),t.emit("local::hide tooltipHide",t),e.addClass("tooltip-out").removeClass("tooltip-in"),t},i.render=function(){var t=this;if(t.params.render)return t.params.render.call(t,t);var e=t.params;return('\n      <div class="tooltip '+(e.cssClass||"")+'">\n        <div class="tooltip-content">'+(e.text||"")+"</div>\n      </div>\n    ").trim()},i.setText=function(t){var e=this;return void 0===t||(e.params.text=t,e.text=t,e.$el&&e.$el.children(".tooltip-content").html(t),e.opened&&e.position()),e},i.init=function(){this.attachEvents()},i.destroy=function(){var t=this;t.$targetEl&&!t.destroyed&&(t.$targetEl.trigger("tooltip:beforedestroy"),t.emit("local::beforeDestroy tooltipBeforeDestroy",t),t.$el.remove(),t.$targetEl[0]&&delete t.$targetEl[0].zmpTooltip,t.detachEvents(),d(t),t.destroyed=!0)},a}(a),v={name:"tooltip",static:{Tooltip:h},create:function(){var t=this;t.tooltip=i({defaultSelector:".tooltip",constructor:h,app:t,domProp:"zmpTooltip"}),t.tooltip.show=function(t){var e=o(t);if(0!==e.length){var r=e[0].zmpTooltip;if(r)return r.show(e[0]),r}},t.tooltip.hide=function(t){var e=o(t);if(0!==e.length){var r=e[0].zmpTooltip;if(r)return r.hide(),r}},t.tooltip.setText=function(t,e){var r=o(t);if(0!==r.length){var n=r[0].zmpTooltip;if(n)return n.setText(e),n}}},params:{tooltip:{targetEl:null,delegated:!1,text:null,cssClass:null,render:null,offset:0,trigger:"hover",containerEl:void 0}},on:{tabMounted:function(t){var e=this;o(t).find(".tooltip-init").each((function(t){var r=o(t).attr("data-tooltip");r&&e.tooltip.create({targetEl:t,text:r})}))},tabBeforeRemove:function(t){o(t).find(".tooltip-init").each((function(t){t.zmpTooltip&&t.zmpTooltip.destroy()}))},pageInit:function(t){var e=this;t.$el.find(".tooltip-init").each((function(t){var r=o(t).attr("data-tooltip");r&&e.tooltip.create({targetEl:t,text:r})})),"ios"===e.theme&&t.view&&t.view.router.dynamicNavbar&&t.$navbarEl&&t.$navbarEl.length>0&&t.$navbarEl.find(".tooltip-init").each((function(t){var r=o(t).attr("data-tooltip");r&&e.tooltip.create({targetEl:t,text:r})}))},pageBeforeRemove:function(t){t.$el.find(".tooltip-init").each((function(t){t.zmpTooltip&&t.zmpTooltip.destroy()})),"ios"===this.theme&&t.view&&t.view.router.dynamicNavbar&&t.$navbarEl&&t.$navbarEl.length>0&&t.$navbarEl.find(".tooltip-init").each((function(t){t.zmpTooltip&&t.zmpTooltip.destroy()}))}},vnode:{"tooltip-init":{insert:function(t){var e=t.elm,r=o(e).attr("data-tooltip");r&&this.tooltip.create({targetEl:e,text:r})},update:function(t){var e=t.elm;e.zmpTooltip&&t&&t.data&&t.data.attrs&&t.data.attrs["data-tooltip"]&&e.zmpTooltip.setText(t.data.attrs["data-tooltip"])},destroy:function(t){var e=t.elm;e.zmpTooltip&&e.zmpTooltip.destroy()}}}};if(e){if(t.prototype.modules&&t.prototype.modules[v.name])return;t.use(v),t.instance&&(t.instance.useModuleParams(v,t.instance.params),t.instance.useModule(v))}return v}(ZMP, typeof ZMPAutoInstallComponent === 'undefined' ? undefined : ZMPAutoInstallComponent))
