<!DOCTYPE html>
<html lang='vi'>
<head>
  <meta charset='utf-8'/>
  <meta name='viewport' content='width=device-width,initial-scale=1'/>
  <title>V·∫≠n chuy·ªÉn - Admin</title>
  <link rel="stylesheet" href="./styles.css"/>
  <script src="./admin_real.js"></script>
  <script src="./sidebar-layout.js"></script>
  
  <style>
    /* Shipping specific styles */
    :root {
      --primary: #1d4ed8;
      --primary-dark: #1e40af;
      --muted: #e5e7eb;
    }

    .toolbar {
      background: white;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .alert {
      background: #fef2f2;
      border: 1px solid #fecaca;
      color: #991b1b;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
    }

    .alert-info {
      background: #eff6ff;
      border: 1px solid #dbeafe;
      color: #1e40af;
    }

    .card { 
      background: #fff; 
      border: 1px solid #e5e7eb; 
      border-radius: 10px;
      padding: 1.5rem;
      margin-bottom: 1rem;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .title { 
      color: var(--primary); 
      font-weight: 600;
      font-size: 1.25rem;
      margin-bottom: 1rem;
    }

    .btn { 
      background: var(--primary); 
      color: #fff; 
      border: 0; 
      border-radius: 8px;
      padding: 0.75rem 1.5rem;
      cursor: pointer;
      font-size: 0.9rem;
      transition: background 0.2s;
    }

    .btn:hover { background: var(--primary-dark); }

    .btn-secondary { 
      background: #6b7280; 
    }

    .btn-secondary:hover { 
      background: #4b5563; 
    }

    .input { 
      border: 1px solid #dbeafe; 
      border-radius: 8px; 
      background: #fff;
      padding: 0.75rem;
      width: 100%;
      font-size: 0.9rem;
    }

    .input:focus {
      outline: none;
      border-color: var(--primary);
    }

    .grid { 
      display: grid; 
      gap: 1rem;
    }

    .grid-2 { 
      grid-template-columns: repeat(2, 1fr); 
    }

    .grid-3 { 
      grid-template-columns: repeat(3, 1fr); 
    }

    small { 
      color: #6b7280; 
      display: block; 
      margin-top: 0.5rem; 
    }

    @media (max-width: 768px) {
      .grid-2, .grid-3 {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>

<!-- Toolbar -->
<div class="toolbar">
  <h2 style="margin: 0; font-size: 18px;">üöö V·∫≠n chuy·ªÉn</h2>
  <button id='sync-warehouses' class='btn'>ƒê·ªìng b·ªô t·ª´ Warehouses</button>
</div>

<!-- Alert -->
<div class="alert alert-info">
  <strong>üí° L∆∞u √Ω:</strong> Nh·∫≠p v√† l∆∞u Super Token tr∆∞·ªõc khi ƒë·ªìng b·ªô warehouse.
</div>

<div class="grid">
  <!-- Ng∆∞·ªùi g·ª≠i -->
  <div class="card">
    <div class="title">Th√¥ng tin ng∆∞·ªùi g·ª≠i</div>
    
    <div class="grid grid-2">
      <input id="sender_name" class="input" placeholder="T√™n ng∆∞·ªùi g·ª≠i">
      <input id="sender_phone" class="input" placeholder="SƒêT ng∆∞·ªùi g·ª≠i">
    </div>

    <div style="margin-top: 1rem;">
      <input id="sender_address" class="input" placeholder="ƒê·ªãa ch·ªâ chi ti·∫øt">
    </div>

    <div class="grid grid-3" style="margin-top: 1rem;">
      <select id="sender_province_sel" class="input">
        <option value="">‚Äî Ch·ªçn T·ªânh/Th√†nh ‚Äî</option>
      </select>
      <select id="sender_district_sel" class="input" disabled>
        <option value="">‚Äî Ch·ªçn Qu·∫≠n/Huy·ªán ‚Äî</option>
      </select>
      <select id="sender_commune_sel" class="input" disabled>
        <option value="">‚Äî Ch·ªçn Ph∆∞·ªùng/X√£ ‚Äî</option>
      </select>
    </div>

    <!-- Hidden fields -->
    <input type="hidden" id="sender_province">
    <input type="hidden" id="sender_district">
    <input type="hidden" id="sender_province_code">
    <input type="hidden" id="sender_district_code">
    <input type="hidden" id="sender_commune_code">
    <input type="hidden" id="option_id" value="1">

    <small>M·∫πo: ch·ªçn t·ª´ danh s√°ch ƒë·ªÉ tr√°nh sai ch√≠nh t·∫£</small>

    <div style="margin-top: 1rem;">
      <button id="save_sender" class="btn">L∆∞u ng∆∞·ªùi g·ª≠i</button>
    </div>
  </div>

  <!-- Super Token -->
  <div class="card">
    <div class="title">Super (Aggregator)</div>
    <div class="grid">
      <input id="super_key" class="input" placeholder="API Super Key (Token header)"/>
      <input id="super_token" class="input" placeholder="Bearer Token (eyJ...)"/>
      <button id="save_super" class="btn">L∆∞u token</button>
    </div>
  </div>

  <!-- J&T -->
  <div class="card">
    <div class="title">J&T</div>
    <div class="grid">
      <input id="jt_key" class="input" placeholder="API Key"/>
      <button id="save_jt" class="btn">L∆∞u</button>
    </div>
  </div>

  <!-- SPX -->
  <div class="card">
    <div class="title">SPX</div>
    <div class="grid">
      <input id="spx_key" class="input" placeholder="API Key"/>
      <button id="save_spx" class="btn">L∆∞u</button>
    </div>
  </div>

  <!-- Grab -->
  <div class="card">
    <div class="title">Grab</div>
    <div class="grid">
      <input id="grab_key" class="input" placeholder="API Key"/>
      <button id="save_grab" class="btn">L∆∞u</button>
    </div>
  </div>
</div>

<!-- Load shipping manager -->
<script src="./shipping-manager.js"></script>

<script>
// Initialize layout
document.addEventListener('DOMContentLoaded', function() {
  console.log('[Shipping] DOM loaded, initializing...');

  // Initialize sidebar layout
  if (window.AdminLayout) {
    AdminLayout.init('V·∫≠n Chuy·ªÉn');
  }

  // Simple credentials handlers
  ['jt', 'spx', 'grab'].forEach(provider => {
    const btn = document.getElementById(`save_${provider}`);
    if (btn) {
      btn.onclick = () => {
        const value = document.getElementById(`${provider}_key`)?.value?.trim() || '';
        localStorage.setItem(`ship_${provider}`, value);
        if (window.Admin?.toast) {
          window.Admin.toast(`ƒê√£ l∆∞u ${provider.toUpperCase()}`);
        } else {
          alert(`ƒê√£ l∆∞u ${provider.toUpperCase()}`);
        }
      };
    }
  });
});
</script>

</body>
</html>